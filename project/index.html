<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <!-- Compiled and minified CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <title>GameGuidez</title>
</head>

<body class="grey lighten-3">

  <!-- NAVBAR -->
  <nav class="z-depth-0 grey lighten-4">
    <div class="nav-wrapper container">
      <a href="#" class="brand-logo">
        <img
          src="https://raw.githubusercontent.com/iamshaunjp/firebase-auth/b3550c0a42fc14d836a24bdd6669c2cd3ad159b8/img/logo.svg"
          style="width: 180px; margin-top: 10px;">
      </a>
      <ul id="nav-mobile" class="right hide-on-med-and-down">
        <li class="logged-in" id="account">
          <a href="#" class="grey-text modal-trigger" data-target="modal-account">Account</a>
        </li>
        <li class="logged-in" id="_logout">
          <a href="#" class="grey-text" id="logout">Logout</a>
        </li>
        <li class="logged-in" id="guide">
          <a href="#" class="grey-text modal-trigger" data-target="modal-create">Create Guide</a>
        </li>
        <li class="logged-out" id="modal_login">
          <a href="#" class="grey-text modal-trigger" data-target="modal-login">Login</a>
        </li>
        <li class="logged-out" id="modal_signup">
          <a href="#" class="grey-text modal-trigger" data-target="modal-signup">Sign up</a>
        </li>
        </span>
      </ul>
    </div>
  </nav>

  <!-- SIGN UP MODAL -->
  <div id="modal-signup" class="modal">
    <div class="modal-content">
      <h4>Sign up</h4><br />
      <form id="signup-form">
        <div class="input-field">
          <input type="email" id="signup-email" required />
          <label for="signup-email">Email address</label>
        </div>
        <div class="input-field">
          <input type="password" id="signup-password" required />
          <label for="signup-password">Choose password</label>
        </div>
        <button class="btn yellow darken-2 z-depth-0">Sign up</button>
      </form>
    </div>
  </div>

  <!-- LOGIN MODAL -->
  <div id="modal-login" class="modal">
    <div class="modal-content">
      <h4>Login</h4><br />
      <form id="login-form">
        <div class="input-field">
          <input type="email" id="login-email" required />
          <label for="login-email">Email address</label>
        </div>
        <div class="input-field">
          <input type="password" id="login-password" required />
          <label for="login-password">Your password</label>
        </div>
        <button class="btn yellow darken-2 z-depth-0">Login</button>
      </form>
    </div>
  </div>

  <!-- ACCOUNT MODAL -->
  <div id="modal-account" class="modal">
    <div class="modal-content center-align">
      <h4>Account details</h4><br />
      <div class="account-details"></div>
    </div>
  </div>

  <!-- CREATE GUIDE MODAL -->
  <div id="modal-create" class="modal">
    <div class="modal-content">
      <h4>Create Guide</h4><br />
      <form id="create-form">
        <div class="input-field">
          <input type="text" id="title" required>
          <label for="title">Guide Title</label>
        </div>
        <div class="input-field">
          <textarea id="content" class="materialize-textarea" required></textarea>
          <label for="content">Guide Content</label>
        </div>
        <button class="btn yellow darken-2 z-depth-0">Create</button>
      </form>
    </div>
  </div>

  <!-- GUIDE LIST -->
  <div class="container" style="margin-top: 40px;">
    <ul class="collapsible z-depth-0 guides" style="border: none;">
      <li>
        <div class="collapsible-header grey lighten-4">Guide title</div>
        <div class="collapsible-body white">Lorem ipsum dolor sit amet.</div>
      </li>
      <li>
        <div class="collapsible-header grey lighten-4">Guide title</div>
        <div class="collapsible-body white"><span>Lorem ipsum dolor sit amet.</span></div>
      </li>
      <li>
        <div class="collapsible-header grey lighten-4">Guide title</div>
        <div class="collapsible-body white"><span>Lorem ipsum dolor sit amet.</span></div>
      </li>
      <li>
        <div class="collapsible-header grey lighten-4">Guide title</div>
        <div class="collapsible-body white"><span>Lorem ipsum dolor sit amet.</span></div>
      </li>
    </ul>
  </div>

  <!-- Compiled and minified JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <script type="module" src="/project/index.js"></script>


  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { getFirestore, collection, addDoc, getDocs, doc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";


    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries



    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "AIzaSyCyF_aNkpbR6KNRdUPyRjUKzB0mfNChfz4",
      authDomain: "testing-ecaf9.firebaseapp.com",
      projectId: "testing-ecaf9",
      storageBucket: "testing-ecaf9.appspot.com",
      messagingSenderId: "616445741218",
      appId: "1:616445741218:web:281aca1c99da1653c86ffb",
      measurementId: "G-0MMVY1Y1MT"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);

    const auth = getAuth(app);

    const db = getFirestore(app);


    function database() {
      async function database() {

        try {
          const docRef = await addDoc(collection(db, "user"), {
            "FirstName": "Kavi",
            "LastName": "Gupta",
            "born": 2002
          });

          console.log("Document written with ID: ", docRef.id);

        } catch (e) {
          console.error("Error adding document: ", e);
        }

      }

      // database();

      async function getdatabase() {
        const querySnapshot = await getDocs(collection(db, "user"));

        querySnapshot.forEach((doc) => {
          console.log(`${doc.id} => ${doc.data()}`);
        });
      }

      // getdatabase();


    }


      onAuthStateChanged(auth, (user) => {
        if (user) {
          
          // let Currentuser = user.currentUser.displayName;

          // console.log(Currentuser);

        } else {
          console.log("User signed out");
        }
      });









      const signupForm = document.querySelector("#signup-form");

      signupForm.addEventListener("submit", (e) => {
        e.preventDefault();

        // get data
        const gmail = document.querySelector("#signup-email").value;
        const password = document.querySelector("#signup-password").value;

        // auth
        createUserWithEmailAndPassword(auth, gmail, password)
          .then((userCredential) => {
            let user = userCredential.user.uid;
            console.log(user);
          })
          .catch((e) => {
            console.log(e.code);
            console.log(e.message);
          });

        const modal = document.querySelector("#modal-signup");
        M.Modal.getInstance(modal).close();


      });


      const logout = document.querySelector("#logout");

      logout.addEventListener("click", (e) => {
        e.preventDefault();

        auth.signOut().then(() => {
          console.log("User signout");
        });

      });



      const loginForm = document.querySelector('#login-form');

      loginForm.addEventListener("submit", (e) => {
        e.preventDefault();

        // get user info
        const email1 = loginForm['login-email'].value;
        const password1 = loginForm['login-password'].value;

        signInWithEmailAndPassword(auth, email1, password1).then((cred) => {

          console.log(cred.user);

          // close the signup modal & reset form
          const modal = document.querySelector('#modal-login');
          M.Modal.getInstance(modal).close();
          loginForm.reset();

        }).catch((e) => {
          console.log(e);
        })

      });
    



  </script>


</body>

</html>